
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Prerequisites &#8212; Polymetis  documentation</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=84ace793992934648b4de8eed757e5a2" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/sphinx-book-theme.9d8b4a8b9bb19db25eeaddc40d639ba2.js"></script>
    <link rel="shortcut icon" href="_static/polymetis-favicon.svg"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Installation" href="installation.html" />
    <link rel="prev" title="Get started" href="index.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<div class="col-12 col-md-3 bd-sidebar site-navigation " id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/polymetis-logo.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Polymetis  documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Prerequisites
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="usage.html">
   Usage
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="troubleshooting.html">
   Troubleshooting
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="polymetis-doc.html">
   Polymetis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="polysim-doc.html">
   Polysim
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="torchcontrol-doc.html">
   TorchControl
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="modules.html">
   Autogenerated docs
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="polymetis.html">
     polymetis package
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="polymetis.robot_client.html">
       polymetis.robot_client package
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="polymetis.utils.html">
       polymetis.utils package
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="polysim.html">
     polysim package
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="polysim.envs.html">
       polysim.envs package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
      <label for="toctree-checkbox-4">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul class="simple">
      </ul>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="torchcontrol.html">
     torchcontrol package
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="torchcontrol.models.html">
       torchcontrol.models package
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="torchcontrol.modules.html">
       torchcontrol.modules package
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="torchcontrol.policies.html">
       torchcontrol.policies package
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="torchcontrol.transform.html">
       torchcontrol.transform package
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="torchcontrol.utils.html">
       torchcontrol.utils package
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<!-- This is an invisible pixel that we watch to see if we've scrolled. -->
<div class="sbt-scroll-pixel-helper"></div>
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            <div class="topbar-left">
                
                <label class="nav-toggle-button" for="__navigation">
                    <div class="visually-hidden">Toggle navigation</div>
                    <i class="fas fa-bars"></i>
                </label>
                
            </div>
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/prereq.md.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulation-environments-only">
   Simulation environments only
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#franka-panda-hardware-setup">
   Franka Panda hardware setup
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-up-the-franka-panda">
     Setting up the Franka Panda
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-up-the-nuc">
     Setting up the NUC
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Prerequisites</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulation-environments-only">
   Simulation environments only
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#franka-panda-hardware-setup">
   Franka Panda hardware setup
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-up-the-franka-panda">
     Setting up the Franka Panda
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-up-the-nuc">
     Setting up the NUC
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="section" id="prerequisites">
<h1>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h1>
<div class="section" id="simulation-environments-only">
<h2>Simulation environments only<a class="headerlink" href="#simulation-environments-only" title="Permalink to this headline">¶</a></h2>
<p>For <strong>simulation</strong>, we simply assume a <a class="reference external" href="https://docs.conda.io/en/latest/">Conda</a> environment with Python 3.8, running on a Linux machine. You may then proceed to <a class="reference internal" href="installation.html"><span class="doc std std-doc">installation</span></a>.</p>
</div>
<div class="section" id="franka-panda-hardware-setup">
<h2>Franka Panda hardware setup<a class="headerlink" href="#franka-panda-hardware-setup" title="Permalink to this headline">¶</a></h2>
<p>To control real-time-capable <strong>hardware</strong> (such as the Franka Panda), we highly recommend running the server on a separate machine (e.g. a <a class="reference external" href="https://www.amazon.com/gp/product/B0842WKBCF/">NUC</a>) with a real-time kernel which is directly connected to the robot.
Your client code should then connect to the server over network and execute any heavy computation (e.g. image processing, planning, GPU usage) to avoid interrupting the real-time control loop on the NUC.</p>
<div class="section" id="setting-up-the-franka-panda">
<h3>Setting up the Franka Panda<a class="headerlink" href="#setting-up-the-franka-panda" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://vention.io/parts/franka-emika-panda-mounting-plate-487">Mounting plate</a> and <a class="reference external" href="https://www.amazon.com/gp/product/B001KPVFJE/">clamps</a><a class="footnote-reference brackets" href="#id3" id="id1">1</a></p></li>
<li><p>Robot stand.</p>
<ol class="arabic simple">
<li><p>A pricier but nice solution is this <a class="reference external" href="https://vention.io/designs/98080">custom-designed</a> stand.</p></li>
</ol>
</li>
<li><p>Networking</p>
<ol class="arabic simple">
<li><p>Connect NUC to Control using Ethernet</p></li>
<li><p>Set the “Wired” network settings on the NUC for control: Manual IPv4 with Address <code class="docutils literal notranslate"><span class="pre">172.16.0.1</span></code>, Netmask <code class="docutils literal notranslate"><span class="pre">255.255.255.0</span></code></p></li>
<li><p>Put GPU-enabled workstation on the same network (could be wireless, since no real-time guarantees for user code).</p></li>
<li><p>Optional: You can use <a class="reference external" href="https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/">FoxyProxy</a> to access Franka Desk from your user machine.</p>
<ol class="arabic simple">
<li><p>In your <code class="docutils literal notranslate"><span class="pre">~/.ssh/config</span></code>, find the entry you use to <code class="docutils literal notranslate"><span class="pre">ssh</span></code> into your NUC. Add <code class="docutils literal notranslate"><span class="pre">DynamicForward</span> <span class="pre">1337</span></code> to that entry and use that port</p></li>
<li><p>Add this to your FoxyProxy settings: <img alt="FoxyProxy" src="_images/foxyproxy.png" /></p></li>
</ol>
</li>
</ol>
</li>
<li><p>Robot firmware upgrade through Franka World. See Franzi’s <a class="reference external" href="https://fb.workplace.com/notes/762408351366858">Facebook-internal note</a> for details</p></li>
</ol>
</div>
<div class="section" id="setting-up-the-nuc">
<h3>Setting up the NUC<a class="headerlink" href="#setting-up-the-nuc" title="Permalink to this headline">¶</a></h3>
<p><em>The following guide is written with specific, known-good version numbers to get you up and running as quickly as possible; other versions will also likely work.</em></p>
<ol class="arabic">
<li><p>Install <a class="reference external" href="https://releases.ubuntu.com/20.04/">Ubuntu 20.04</a> or <a class="reference external" href="https://releases.ubuntu.com/18.04/">Ubuntu 18.04.5</a></p></li>
<li><p>The Franka documentation has a <a class="reference external" href="https://frankaemika.github.io/docs/installation_linux.html#setting-up-the-real-time-kernel">comprehensive guide</a> on installing real-time kernel. Here is a condensed version<a class="footnote-reference brackets" href="#id4" id="id2">2</a>:</p>
<ol class="arabic">
<li><p>Install prereqs:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> sudo apt install build-essential bc curl ca-certificates gnupg2 libssl-dev lsb-release libelf-dev bison flex
</pre></div>
</div>
</li>
<li><p>Download known-good kernel and patch (Ubuntu 20)</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> curl -SLO https://mirrors.edge.kernel.org/pub/linux/kernel/v5.x/linux-5.11.tar.xz
 curl -SLO https://mirrors.edge.kernel.org/pub/linux/kernel/projects/rt/5.11/older/patch-5.11-rt7.patch.xz
 xz -d linux-5.11.tar.xz
 xz -d patch-5.11-rt7.patch.xz
</pre></div>
</div>
<ol class="arabic">
<li><p>Ubuntu 18 links (update version numbers for future commands)</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> curl -SLO https://mirrors.edge.kernel.org/pub/linux/kernel/v5.x/linux-5.4.70.tar.xz
 curl -SLO https://mirrors.edge.kernel.org/pub/linux/kernel/projects/rt/5.4/older/patch-5.4.70-rt40.patch.xz
 xz -d linux-5.4.70.tar.xz
 xz -d patch-5.4.70-rt40.patch.xz
</pre></div>
</div>
</li>
</ol>
</li>
<li><p>Extract the kernel and apply the patch:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> tar xf linux-5.11.tar
 cd linux-5.11
 patch -p1 &lt; ../patch-5.11-rt7.patch
</pre></div>
</div>
</li>
<li><p>Configure the kernel:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> make oldconfig
</pre></div>
</div>
<p>Choose <code class="docutils literal notranslate"><span class="pre">Fully</span> <span class="pre">Preemptible</span> <span class="pre">Kernel</span></code> when asked for Preemption Model, and leave the rest to defaults (keep pressing <code class="docutils literal notranslate"><span class="pre">Enter</span></code>).</p>
<p>Set the following values in the <code class="docutils literal notranslate"><span class="pre">.config</span></code> file:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SYSTEM_TRUSTED_KEYS</span> <span class="pre">=</span> <span class="pre">&quot;&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_MODULE_SIG_KEY=&quot;certs/signing_key.pem&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SYSTEM_TRUSTED_KEYRING=y</span></code></p></li>
</ul>
</li>
<li><p>Compile the kernel: <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">make</span> <span class="pre">-j4</span> <span class="pre">deb-pkg</span></code></p>
<ul class="simple">
<li><p>This takes a long time, so set <code class="docutils literal notranslate"><span class="pre">-j</span></code> to use more cores.</p></li>
<li><p>If you get <code class="docutils literal notranslate"><span class="pre">kernel</span> <span class="pre">signature</span> <span class="pre">invalid</span></code> error, disable secure boot in your BIOS.</p></li>
</ul>
</li>
<li><p>Install the kernel:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> sudo dpkg -i ../linux-headers-5.11.0-rt7_*.deb ../linux-image-5.11.0-rt7_*.deb
</pre></div>
</div>
</li>
<li><p>Follow the rest of the instructions in <a class="reference external" href="https://frankaemika.github.io/docs/installation_linux.html#verifying-the-new-kernel">Franka’s guide</a> to verify the kernel and allow a user to set real-time permissions.</p></li>
</ol>
</li>
</ol>
<p>You are now ready to install Polymetis.</p>
<hr class="docutils" />
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="id3"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Credit to Vikash Kumar for documenting the hardware installation process.</p>
</dd>
<dt class="label" id="id4"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Credit to Akshara Rai for going through the process and debugging these quirks.</p>
</dd>
</dl>
</div>
</div>
</div>


              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="index.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Get started</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="installation.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Installation</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Yixin Lin, Austin Wang<br/>
    
        &copy; Copyright 2021, Facebook Inc..<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>